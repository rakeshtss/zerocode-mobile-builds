(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{"920x":function(t,a){t.exports=".internal-rating .category-header,.internal-rating .sub-category-header{color:#221f60}.internal-rating .category-title-header{font-size:14px;padding-bottom:5px !important;color:#221f60}.internal-rating p-accordiontab .ui-accordion-content{border:none !important}.internal-rating p-accordiontab .ui-accordion-header,.internal-rating p-accordiontab .ui-state-active{margin:0 !important;border:none !important}.internal-rating p-accordiontab .ui-accordion-header :hover,.internal-rating p-accordiontab .ui-state-active :hover{color:black !important}.internal-rating p-accordiontab .ui-accordion-header a,.internal-rating p-accordiontab .ui-accordion-header .ui-accordion-toggle-icon,.internal-rating p-accordiontab .ui-state-active a,.internal-rating p-accordiontab .ui-state-active .ui-accordion-toggle-icon{border:none !important;background-color:#fef0d3 !important;color:black !important}.internal-rating p-accordiontab .ui-accordion-header>a,.internal-rating p-accordiontab .ui-state-active>a{padding:0 !important;display:flex;align-items:center}.internal-rating p-accordiontab .ui-accordion-header>a:focus,.internal-rating p-accordiontab .ui-state-active>a:focus{outline:none}.internal-rating p-accordiontab .ui-accordion-header>a .category-header .highlight,.internal-rating p-accordiontab .ui-state-active>a .category-header .highlight{padding:10px;background-color:#FAEDB6;color:#221f60;border-right:3px solid #fff;text-align:center !important}.internal-rating p-accordiontab .ui-accordion-header>a .ui-accordion-toggle-icon,.internal-rating p-accordiontab .ui-state-active>a .ui-accordion-toggle-icon{min-width:30px}.internal-rating p-accordiontab .ui-accordion-header>a p-header,.internal-rating p-accordiontab .ui-state-active>a p-header{width:100%}.internal-rating p-accordiontab .ui-accordion-header>a p-header .category-header,.internal-rating p-accordiontab .ui-state-active>a p-header .category-header{margin:0 !important}.internal-rating p-accordiontab .ui-accordion-header>a p-header .category-header .header-left,.internal-rating p-accordiontab .ui-state-active>a p-header .category-header .header-left{display:flex;align-items:center;padding-left:0}.internal-rating p-accordiontab p-accordiontab .ui-accordion-header{border:0px !important}.internal-rating p-accordiontab p-accordiontab .ui-accordion-header,.internal-rating p-accordiontab p-accordiontab .ui-state-active{border-bottom:1px solid #ccc !important}.internal-rating p-accordiontab p-accordiontab .ui-accordion-header :hover,.internal-rating p-accordiontab p-accordiontab .ui-state-active :hover{color:black !important}.internal-rating p-accordiontab p-accordiontab .ui-accordion-header a:focus,.internal-rating p-accordiontab p-accordiontab .ui-state-active a:focus{outline:inherit !important}.internal-rating p-accordiontab p-accordiontab .ui-accordion-header a,.internal-rating p-accordiontab p-accordiontab .ui-accordion-header .ui-accordion-toggle-icon,.internal-rating p-accordiontab p-accordiontab .ui-state-active a,.internal-rating p-accordiontab p-accordiontab .ui-state-active .ui-accordion-toggle-icon{background-color:white !important;border:none !important;color:#221f60 !important}.internal-rating p-accordiontab p-accordiontab .ui-accordion-header>a,.internal-rating p-accordiontab p-accordiontab .ui-state-active>a{padding:0.571em 1em !important}\n"},"N+aR":function(t,a,n){"use strict";n.r(a);var i=n("D57K"),o=n("LoAr"),e=n("WT9V"),r=n("981U"),c=n("05nE"),s=n("vtXP"),d=function(){function t(t){this.http=t}return t.prototype.getSurveyDetails=function(t,a){return this.http.post(t,a).pipe(Object(s.a)(function(t){return t.data}))},t.prototype.saveEditSurvey=function(t,a){return this.http.post(t,a)},t=i.c([Object(o.Injectable)(),i.f("design:paramtypes",[c.c])],t)}(),p=function(){function t(t,a,n){this.irs=t,this.as=a,this.route=n,this.isReadonly=!1,this.showBtn=!1,this.model={}}return t.prototype.ngOnInit=function(){var t=this,a=this.route.snapshot.params;if(this.payload={survey:this.options.survey,uid:a.uid},this.options.api.params&&this.options.api.params.length>0){var n=this.as.getParams(this.options.api.params,zc);Object.assign(this.payload,n)}var i=this.checkMode(this.options.mode);"view"===i&&(this.isReadonly=!0),this.irs.getSurveyDetails(this.options.api.list,this.payload).subscribe(function(a){var n=JSON.parse(JSON.stringify(a));t.weightageConfig=n.widgetMeta.weightage_config,a.widgetMeta&&a.widgetMeta.entity&&(t.payload.entity=a.widgetMeta.entity),t.questionList=n.categories,t.updateFormula(),"view"!==i&&(t.showBtn=!0)}),this.zcFormOptions={id:this.options.id+"Form",mode:this.options.mode,fields:this.options.fields}},t.prototype.ngAfterViewInit=function(){zc[this.options.id]=this},t.prototype.reload=function(){this.ngOnInit()},t.prototype.ngDoCheck=function(){},t.prototype.dropDownChange=function(t,a){a.answer=t.value,this.updateFormula()},t.prototype.inputTextChange=function(t,a){console.log("event",t),this.updateFormula()},t.prototype.updateFormula=function(){this.questionList.map(function(t){t.category.calWeightage=0;var a=0,n=0;t.subCategories.map(function(t){var i=0,o=0;if(t.questions.forEach(function(t){t.answer&&t.answer.weightage>0&&(i+=t.answer.weightage,o+=1)}),i/=o,i=isNaN(i)?0:i.toFixed(2),t.subCategory.calWeightage=i,i>0){var e=parseFloat(t.weightage)/100;a+=e*i,n+=e}}),t.category.calWeightage=(a/n).toFixed(2),console.log("category weightage",t.category.calWeightage)})},t.prototype.checkMode=function(t){try{return new Function("return "+t+" ; ")()}catch(a){console.log("key",t)}},t.prototype.submit=function(t){var a=this;console.log("arg",t);var n=this.getAnswers();if(this.payload.answers=n,t&&t.params){var i=this.as.getParams(t.params,zc);Object.assign(this.payload,i)}this.irs.saveEditSurvey(this.options.api.save,this.payload).subscribe(function(n){a.as.onSuccess(t.onSuccess,{})})},t.prototype.submitBySubCategory=function(t,a){var n=this.getAnswersBySubCategory(t,a);if(this.payload.answers=n,this.options.api.params){var i=this.as.getParams(this.options.api.params,zc);Object.assign(this.payload,i)}this.irs.saveEditSurvey(this.options.api.save,this.payload).subscribe(function(t){})},t.prototype.getAnswersBySubCategory=function(t,a){var n=[];return a.questions.forEach(function(i){if(i.answer){var o={category:t.category.code,subCategory:a.subCategory.code,question:i.code,type:i.type,answer:i.answer};n.push(o)}}),n},t.prototype.getAnswers=function(){var t=[];return this.questionList.forEach(function(a){a.subCategories.forEach(function(n){n.questions.forEach(function(i){if(i.answer){var o={category:a.category.code,subCategory:n.subCategory.code,question:i.code,type:i.type,answer:i.answer};t.push(o)}})})}),t},i.c([Object(o.Input)(),i.f("design:type",Object)],t.prototype,"options",void 0),t=i.c([Object(o.Component)({selector:"zc-survey-internal-rating",template:n("l+4N"),encapsulation:o.ViewEncapsulation.None,styles:[n("920x")]}),i.f("design:paramtypes",[d,c.a,r.ActivatedRoute])],t)}(),l=n("Hhcr"),u=n("Hpdm"),g=n("IfiR"),h=function(){function t(){}return t.prototype.transform=function(t,a){console.log("value",t),console.log("args",a);var n=0;return a.forEach(function(t){t.answer&&(n+=t.answer.weightage)}),n},t=i.c([Object(o.Pipe)({name:"internalFactor"})],t)}(),b=n("pnHo");n.d(a,"InternalRatingModule",function(){return v});var v=function(){function t(){}return t=i.c([Object(o.NgModule)({declarations:[p,h],imports:[e.CommonModule,b.a,l.AccordionModule,u.DropdownModule,g.FormsModule],providers:[d],exports:[p]})],t)}()},"l+4N":function(t,a){t.exports='<div class="internal-rating bg-white survey-header">\n  <h3 class="header p-2" *ngIf="options.title">{{ options.title }}</h3>\n  <div class="body p-4">\n    <div class="row col-12 m-0 p-0 category-title-header">\n      <div class="col-9 pl-0">Business Risks Categories</div>\n      <div class="col-3">\n        <div class="row">\n          <div class="col-6 text-center">Factor</div>\n          <div class="col-6 text-center">Weight(%)</div>\n        </div>\n      </div>\n    </div>\n    <p-accordion [multiple]="true">\n      <p-accordionTab\n        [selected]="true"\n        [cache]="true"\n        *ngFor="let category of questionList"\n      >\n        <p-header>\n          <div class="category-header">\n            <div class="row col-12 m-0 p-0">\n              <div class="col-9 header-left">{{ category.category.name }}</div>\n              <div class="col-3">\n                <div class="row">\n                  <div class="col-6 text-right highlight">\n                    {{ category.category.calWeightage || \'0.00\' }}\n                  </div>\n                  <div class="col-6 text-right highlight">\n                    {{ category.weightage }} %\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </p-header>\n        <p-accordion [multiple]="true">\n          <p-accordionTab\n            [selected]="false"\n            [cache]="true"\n            *ngFor="let subCategory of category.subCategories"\n          >\n            <p-header>\n              <div class="sub-category-header">\n                <div class="row col-12 m-0 p-0">\n                  <div class="col-9 pl-0">\n                    {{ subCategory.subCategory.name }}\n                  </div>\n                  <div class="col-3">\n                    <div class="row">\n                      <div class="col-6 text-right">\n                        {{ subCategory.subCategory.calWeightage || \'0.00\' }}\n                      </div>\n                      <div class="col-6 text-right">\n                        {{ subCategory.weightage }} %\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </p-header>\n            <div *ngFor="let question of subCategory.questions">\n              <div class="question">\n                <div class="row col-12">\n                  <div class="col">\n                    <label>{{ question.question }}</label>\n                  </div>\n                  <div class="col-4">\n                    <p-dropdown\n                      [disabled]="isReadonly"\n                      optionLabel="name"\n                      appendTo="body"\n                      dataKey="uid"\n                      [style]="{ width: \'100%\' }"\n                      placeholder="select any options"\n                      [options]="question.options_data.data"\n                      [(ngModel)]="question.answer"\n                      (onChange)="dropDownChange($event, question)"\n                    ></p-dropdown>\n                  </div>\n                  <div class="col-2">\n                    <input\n                      type="number"\n                      [readonly]="isReadonly"\n                      min="0"\n                      class="form-control"\n                      *ngIf="question.answer"\n                      (change)="inputTextChange($event, question)"\n                      [(ngModel)]="question.answer.weightage"\n                    />\n                  </div>\n                </div>\n              </div>\n            </div>\n            \x3c!--\n              <div class="col-12 text-right p-2 pr-5">\n                <button type="submit" (click)="submitBySubCategory(category,subCategory)"\n                  class="btn btn-primary submit-button">Save</button>\n              </div>\n            --\x3e\n          </p-accordionTab>\n        </p-accordion>\n      </p-accordionTab>\n    </p-accordion>\n  </div>\n  <div class="footer text-center pb-2" *ngIf="showBtn">\n    <zc-form [options]="zcFormOptions" [model]="model"></zc-form>\n    \x3c!-- <button\n      type="submit"\n      (click)="submit()"\n      class="btn btn-primary submit-button"\n    >\n      Submit\n    </button> --\x3e\n  </div>\n</div>\n'}}]);